<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=1024" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<title>WebGL Codelab</title>

<meta name="description" content="WebGL Codelab DevFest BCN" />
<meta name="author" content="Alberto Alonso Ruibal" />

<link href="css/impress.css" rel="stylesheet" />
<link href='http://fonts.googleapis.com/css?family=Finger+Paint' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
</head>

<body class="impress-not-supported">

	<div class="fallback-message">
		<p>
			Your browser <b>doesn't support the features required</b> by
			impress.js, so you are presented with a simplified version of this
			presentation.
		</p>
		<p>
			For the best experience please use the latest <b>Chrome</b>, <b>Safari</b>
			or <b>Firefox</b> browser.
		</p>
	</div>

	<div id="impress">

		<div id="start" class="step slide" data-x="0" data-y="0" data-z="5000">
			<h1>WebGL Three.js Codelab</h1>
			<br /> <img src="img/intro.jpg"
				style="display: block; margin-left: auto; margin-right: auto;">
			<br>
			<span class="footnote">DevFest-X BCN, November 2012</span>
		</div>

		<div class="step slide" data-x="1000" data-y="0" data-z="4000" data-rotate="10" data-scale="1">
			<h1>Why WebGL?</h1>
			<ul>
				<li>Advanced Graphics in the browser</li>
				<li>Direct Access to the GPU: acceleration</li>
				<li>Javascript API</li>
				<li>Plugin-free</li>
				<li>Based on OpenGL ES 2.0</li>
			</ul>
		</div>

		<div class="step slide" data-x="2000" data-y="0" data-z="3000"
			data-rotate="-10" data-scale="1">
			<h1>The WebGL Mess</h1>
			WebGL needs knowledge about:
			<ul>
				<li>Vertex Shaders</li>
				<li>Fragment Shaders</li>
				<li>Uniforms</li>
				<li>Varyings</li>
				<li>Matrices</li>
				<li>...</li>
			</ul>
			WebGL doesn't know about cameras, models, materials...
		</div>

		<div class="step slide" data-x="3000" data-y="0" data-z="2000" data-rotate="10">
			<h1>Three.js</h1>
			<p>Lightweight library that provides a object model with:</p>
			<ul>
				<li>Scene</li>
				<li>Geometry</li>
				<li>Material</li>
				<li>Mesh</li>
				<li>Light</li>
				<li>...</li>
			</ul>
			And a "Renderer" to draw the scene (also model load...)
		</div>

		<div class="step slide" data-x="4000" data-y="0" data-z="1000" data-rotate="-10">
			<h1>About Three.js</h1>
			<img src="img/cabello.png" style="float: right">
			By Ricardo Cabello (@mrdoob)
			<ul>
				<li><a href="https://plus.google.com/104300307601542851567/posts">Google Plus page</a></li>
				<li>Three.js in GitHub <a href="https://github.com/mrdoob/three.js/">https://github.com/mrdoob/three.js/</a></li>
			</ul>
		</div>

		<div class="step slide" data-x="0" data-y="1000" data-z="5000" data-rotate="0" data-scale="1"">
			<h1>Using Three.js</h1>
			<ul>
			</ul>
			Inline code editor<br>
			<a href="http://mrdoob.com/projects/code-editor/">http://mrdoob.com/projects/code-editor/</a></li>
			<br>
			Download three.min.js from <a href="https://github.com/mrdoob/three.js/build/">https://github.com/mrdoob/three.js/build/</a> and create an empty page			
		</div>

		<div class="step slide" data-x="1000" data-y="1000" data-z="4000" data-rotate="10" data-scale="1"">
			<h1>Setup Scene and Renderer</h1>
<pre><code>&lt;script src="js/three.min.js"&gt;&lt;/script&gt;&lt;script&gt;
var scene, renderer;
init();
function init() {
	scene = new THREE.Scene();
	renderer = new THREE.WebGLRenderer();
	renderer.setSize(window.innerWidth, window.innerHeight);
	document.body.appendChild(renderer.domElement);
}
&lt;/script&gt;
</code></pre>
		</div>

		<div class="step slide" data-x="2000" data-y="1000" data-z="3000" data-rotate="-10" data-scale="1"">
			<h1>Camera and Render</h1>
<pre><code>var camera;
//...
camera = new THREE.PerspectiveCamera(45,
	window.innerWidth / window.innerHeight, 1, 10000);
camera.position = new THREE.Vector3(0, 0, 1000);
</code></pre>

To render each frame we call:

<pre><code>renderer.render(scene, camera);
</code></pre>
		</div>

		<div class="step slide" data-x="3000" data-y="1000" data-z="2000" data-rotate="10" data-scale="1"">
			<h1>Adding a Mesh</h1>
<pre><code>// Create a Geometry
geometry = new THREE.CubeGeometry(200, 200, 200);
// Create a Material
material = new THREE.MeshLambertMaterial({
	color : 0xffffff,
});
// Create a Mesh with the Geometry and the Material
mesh = new THREE.Mesh(geometry, material);
// Add it to the Scene
scene.add(mesh);</code></pre>
		</div>

		<div class="step slide" data-x="4000" data-y="1000" data-z="1000" data-rotate="0" data-scale="1"">
			<h1>Adding a Light</h1>
<pre><code>// Create a Point Light 
pointLight = new THREE.PointLight( 0xffffff );
// Set the point light position 
pointLight.position = new THREE.Vector3(1000, 1000, 0);
// Add the light to the scene
scene.add( pointLight );</code></pre>
		</div>

		<div class="step slide" data-x="5000" data-y="1000" data-z="0" data-rotate="-10" data-scale="1"">
			<h1>Animating</h1>
<pre><code>animate();
function animate() {
	// Ask for the next frame
	requestAnimationFrame(animate);
	// Rotate Cube
	mesh.rotation.x += 0.01;
	mesh.rotation.y += 0.02;
	// Render Frame
	renderer.render(scene, camera);
}</code></pre>
		</div>

		<div class="step slide" data-x="10000" data-y="1000" data-z="10000" data-scale="1"">
			<h1>A Basic WebGL Scene</h1>
			<iframe src="step1.html" width="800" height="500"></iframe>
		</div>
		
		<div class="step slide" data-x="0" data-y="2000" data-z="5000" data-rotate="0" data-scale="1"">
			<h1>Loading models</h1>
			Download from Three.js GitHub:
			<ul>
				<li>examples/js/loaders/ColladaLoader.js</li>
			</ul>
			place it in js/ and load it:
<pre><code>&lt;script src="js/ColladaLoader.js"&gt;&lt;/script&gt;</code></pre>
<br>
			To test model load in local you will need to start Chrome with:<br><b>chrome --allow-file-access-from-files</b>
		</div>

		<div class="step slide" data-x="1000" data-y="2000" data-z="4000" data-rotate="10" data-scale="1"">
			<h1>Export a Model with SketchUp</h1>
			<center><img src="img/sketchup.png"></center>
			<ul>
				<li>We will use the collada format (.dae)</li>
				<li>Be careful with groups</li>
			</ul>
		</div>
		
		<div class="step slide" data-x="2000" data-y="2000" data-z="3000" data-rotate="-10" data-scale="1"">
			<h1>Load the model</h1>
			Using the ColladaLoader
			<pre><code>var loader = new THREE.ColladaLoader();
loader.options.convertUpAxis = true;
loader.load('./car.dae', function(collada) {
	// Onload function
	car = collada.scene;
	init();
	animate();
});</code></pre>
		</div>

		<div class="step slide" data-x="3000" data-y="2000" data-z="2000" data-rotate="10" data-scale="1"">
			<h1>Camera</h1>
			Make the camera look at (0,0,0):
<pre><code>camera = new THREE.PerspectiveCamera(45,
	window.innerWidth / window.innerHeight, 1, 10000);
camera.position = new THREE.Vector3(0, 1000, 1000);
camera.lookAt(new THREE.Vector3(0, 0, 0));</code></pre>
		</div>
		
		<div class="step slide" data-x="4000" data-y="2000" data-z="1000" data-rotate="-10" data-scale="1"">
			<h1>Animation</h1>
			We will rotate the car in each frame
<pre><code>function animate() {
	requestAnimationFrame(animate);
	car.rotation.y += 0.02;
	renderer.render(scene, camera);
}</code></pre>
		</div>
		
		<div class="step slide" data-x="10000" data-y="2000" data-z="10000" data-scale="1"">
			<h1>The Loaded Model</h1>
			<iframe src="step2.html" width="800" height="500"></iframe>
		</div>

		<div class="step slide" data-x="0" data-y="3000" data-z="5000" data-rotate="0" data-scale="1"">
			<h1>A Basic Game Scenery</h1>
			
			Setup keyboard control:
			
<pre><code>keyDown = new Array();
for (i = 0; i < 300; i++) keyDown[i] = false;
document.onkeydown = function(event) {
	keyDown[event.keyCode] = true;
}
document.onkeyup = function(event) {
	keyDown[event.keyCode] = false;
}</code></pre>
		</div>

		<div class="step slide" data-x="1000" data-y="3000" data-z="4000" data-rotate="10" data-scale="1"">
			<h1>Accelerate and brake</h1>
			We will add this code in the animate() loop: 
<pre><code>if (keyDown[38]) { // if Up is pressed
	if (speed < 100) speed += 0.5;
} else {
	speed -= 1;						
	if (speed < 0) speed = 0;
}</code></pre>
		</div>

		<div class="step slide" data-x="2000" data-y="3000" data-z="3000" data-rotate="0" data-scale="1"">
			<h1>Rotate and move the car</h1>
			Rotate on left/right press:
<pre><code>if (speed > 0) {
	if (keyDown[37]) car.rotation.y += 0.02;
	if (keyDown[39]) car.rotation.y -= 0.02;
}</code></pre>
			And move the car:
<pre><code>car.position.x += speed * Math.sin(car.rotation.y);
car.position.z += speed * Math.cos(car.rotation.y);</code></pre>
		</div>

		<div class="step slide" data-x="3000" data-y="3000" data-z="2000" data-rotate="-10" data-scale="1"">
			<h1>And more...</h1>
			Camera looking at the car:
<pre><code>camera.lookAt(car.position);</code></pre>
		</div>

		<div class="step slide" data-x="4000" data-y="3000" data-z="1000" data-rotate="10" data-scale="1"">
			<h1>Create a Plane</h1>
			As a reference for the car movement
<pre><code>geometry = new THREE.PlaneGeometry(
	50000, 50000, 100, 100);
material = new THREE.MeshBasicMaterial({
	color : 0xcccccc,
	wireframe : true});
mesh = new THREE.Mesh(geometry, material);
mesh.rotation.x = Math.PI / 2;
scene.add(mesh);</code></pre>
		</div>

		<div class="step slide" data-x="10000" data-y="3000" data-z="10000" data-scale="1"">
			<h1>Play!</h1>
			<iframe src="step3.html" width="800" height="500"></iframe>
			</ul>
			Accelerate with &uarr;, steer with &larr; and &rarr;
		</div>

		<div class="step slide" data-x="0" data-y="4000" data-z="5000" data-rotate="0">
			<h1>More Three.js Demos</h1>

			<ul>
				<li>Official examples <a href="http://mrdoob.github.com/three.js/">http://mrdoob.github.com/three.js/</a></li>
				<li>Mr Doob page: <a href="http://mrdoob.com/">http://mrdoob.com/</a></li>
				<li>Hello Racer: <a href="http://helloracer.com/webgl/">http://helloracer.com/webgl/</a></li>
				<li>Trigger Rally: <a href="http://triggerrally.com//">http://triggerrally.com/</a></li>
				<li>HexGL: <a href="http://hexgl.bkcore.com/">http://hexgl.bkcore.com/</a></li>
				<li>Nissan Juke: <a href="http://pierrelepers.com/lab/jthree/">http://pierrelepers.com/lab/jthree/</a></li>
			</ul>
		</div>
		
		<div class="step slide" data-x="1000" data-y="4000" data-z="4000" data-rotate="10">
			<h1>And More Three.js Resources</h1>

			<ul>
				<li>Official Three.js doc <a href="http://mrdoob.github.com/three.js/docs/52/">http://mrdoob.github.com/three.js/docs/52/</a></li>
				<li>Basics of Three.js (Ilmari Heikkinen) <a href="http://fhtr.org/BasicsOfThreeJS/">http://fhtr.org/BasicsOfThreeJS/</a></li>
				<li>Intro at AeroTwist by Paul Lewis <a href="http://www.aerotwist.com/tutorials/getting-started-with-three-js/">http://www.aerotwist.com/tutorials/getting-started-with-three-js/</a></li>
			</ul>
		</div>

		<div id="overview" class="step" data-x="3000" data-y="1500" data-z="5000"
			data-scale="10"></div>
	</div>

	<link rel="stylesheet" href="css/default.css">
	<script src="js/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

	<script src="js/impress.js"></script>
	<script>
		impress().init();
	</script>
</body>
</html>
